/*!CK:2903320118!*//*1379467144,178557515*/

if (self.CavalryLogger) { CavalryLogger.start_js(["nm8KM"]); }

__d("Button.react",["AbstractButton.react","ReactPropTypes","React","cx"],function(a,b,c,d,e,f){var g=b('AbstractButton.react'),h=b('ReactPropTypes'),i=b('React'),j=b('cx'),k=i.createClass({displayName:'Button',propTypes:{use:h.oneOf(['special','confirm','default']),size:h.oneOf(['medium','large']),suppressed:h.bool},render:function(){var l=this.props.use||'default',m=this.props.size||'medium',n=(("_42fu")+(l==='special'?' '+"_42gz":'')+(l==='confirm'?' '+"_42g-":'')+(m==='large'?' '+"_42gy":'')+(this.props.suppressed?' '+"_42gx":'')+(l!=='default'?' '+"selected":''));return this.transferPropsTo(g({className:n}));}});e.exports=k;});
__d("WebMessengerMasterViewControlManager",["ArbiterMixin","DOM","WebMessengerFlexibleScrollArea","WebMessengerMasterViewTabBarControl","WebMessengerMasterViewSearchInputControl","WebMessengerMasterViewRecentThreadsControl","WebMessengerMasterViewSearchThreadsControl","WebMessengerStateManager","WebMessengerStateConstants","Style","WebMessengerTemplates","WebMessengerEvents","WebMessengerSubscriptionsHandler","mixin"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('DOM'),i=b('WebMessengerFlexibleScrollArea'),j=b('WebMessengerMasterViewTabBarControl'),k=b('WebMessengerMasterViewSearchInputControl'),l=b('WebMessengerMasterViewRecentThreadsControl'),m=b('WebMessengerMasterViewSearchThreadsControl'),n=b('WebMessengerStateManager'),o=b('WebMessengerStateConstants'),p=b('Style'),q=b('WebMessengerTemplates'),r=b('WebMessengerEvents'),s=b('WebMessengerSubscriptionsHandler'),t=b("mixin"),u=t(g);for(var v in u)if(u.hasOwnProperty(v))x[v]=u[v];var w=u===null?null:u.prototype;x.prototype=Object.create(w);x.prototype.constructor=x;x.__superConstructor__=u;function x(y){this._rootElement=y;h.empty(this._rootElement);var z=q[':fb:web-messenger:master-view'].build();h.setContent(this._rootElement,z.getRoot());this._tabBarControl=new j(this,z.getNode('masterViewTabBar'),z.getNode('masterViewTopContent'));this._searchInputControl=new k(this,z.getNode('masterViewSearchInput'));this._searchThreadsControl=new m(this,z.getNode('masterViewSearchThreads'),z.getNode('searchMessagesIndicator'),z.getNode('noMessages'));this._threadlistRowsWrapper=z.getNode('threadlistRowsWrapper');this._flexArea&&this._flexArea.destroy();var aa={fade:true,persistent:true};this._flexArea=new i(this._threadlistRowsWrapper,aa).setInfiniteScrollHandler(this.inform.bind(this,'scrolledNearBottom')).setContainer(this._rootElement).setMinFlexAreaHeight(40).draw();this._recentThreadsControl=new l(this,z.getNode('masterViewRecentThreads'),z.getNode('masterInfoBox'),z.getNode('masterViewTabBar'));s.addSubscriptions(r.subscribe(r.FOCUS_AND_SELECT_SEARCH,this._searchInputControl.focusAndSelectSearch.bind(this._searchInputControl)),r.subscribe(r.FOCUS_SEARCH,this._searchInputControl.focus.bind(this._searchInputControl)),r.subscribe(r.MASTER_DOM_CHANGED,function(){this._tabBarControl.updateView();this._flexArea&&this._flexArea.draw();}.bind(this)),n.subscribe(o.STATE_CHANGE_EVENT,this.updateOnStateChange.bind(this)));this._resizeNodes=[this._rootElement,this._threadlistRowsWrapper,h.find(this._threadlistRowsWrapper,'div.uiScrollableAreaBody')];}x.prototype.updateOnStateChange=function(){var y=n.getCurrentMasterState();this._tabBarControl.updateView();this._searchInputControl.updateView();switch(y){case o.MASTER.RECENT_THREADS:this._searchThreadsControl.hideView();this._recentThreadsControl.updateView();break;case o.MASTER.SEARCH:this._recentThreadsControl.hideView();this._searchThreadsControl.updateView();break;}};x.prototype.scrollIntoView=function(y,z){this._flexArea&&this._flexArea.scrollIntoView(y,z);};x.prototype.scrollToBottom=function(y){this._flexArea&&this._flexArea.scrollToBottom(y);};x.prototype.scrollToTop=function(y){this._flexArea&&this._flexArea.scrollToTop(y);};x.prototype.isScrolledToTop=function(){return this._flexArea&&this._flexArea.isScrolledToTop();};x.prototype.getScrollTop=function(){return this._flexArea.getScrollableArea().getScrollTop();};x.prototype.draw=function(){this._flexArea&&this._flexArea.draw();};x.prototype.poke=function(){this._flexArea&&this._flexArea.poke();};x.prototype.sizeToFit=function(y){this._flexArea&&this._flexArea.setSizeToFit(y);};x.prototype.setScrollCallback=function(y){this._flexArea&&this._flexArea.setScrollCallback(y);};x.prototype.forceFireScrollCallbacks=function(){this._flexArea&&this._flexArea._onScroll();};x.prototype.getFlexAreaElement=function(){return this._flexArea.flexArea;};x.prototype.resizeTo=function(y){this._resizeNodes.forEach(function(z){p.set(z,'width',y+'px');});r.masterDOMChanged();};x.prototype.destroy=function(){this._tabBarControl.destroy();this._recentThreadsControl.destroy();this._searchThreadsControl.destroy();this._flexArea.destroy();};e.exports=x;});
__d("WebMessengerActionsMenuItem",["Event","CSS","WebMessengerStateManager","WebMessengerTemplates"],function(a,b,c,d,e,f){var g=b('Event'),h=b('CSS'),i=b('WebMessengerStateManager'),j=b('WebMessengerTemplates');function k(l,m,n){var o=j[':fb:web-messenger:actions-menu-item'].build();o.setNodeContent('title',l);this.node=o.getRoot();this.showFn=n;g.listen(this.node,'click',function(){var p=i.getCurrentStateData().thread_id;p&&m(p);});}k.prototype.getNode=function(){return this.node;};k.prototype.updateShown=function(l){var m=this.showFn?this.showFn(l):true;h.conditionShow(this.node,m);return m;};e.exports=k;});
__d("MercuryDataSourceHelper",["MercuryPayloadSource","MercuryServerRequests","MercuryThreadMetadataRawRenderer","MercuryThreadMetadataRenderer","WebMessengerConstants"],function(a,b,c,d,e,f){var g=b('MercuryPayloadSource'),h=b('MercuryServerRequests').get(),i=b('MercuryThreadMetadataRawRenderer'),j=b('MercuryThreadMetadataRenderer').get(),k=b('WebMessengerConstants'),l={updateMercuryOnFetchComplete:function(m){m.subscribe('fetchComplete',function(n,o){var p={participants:[],threads:[],payload_source:g.SERVER_SEARCH};o.response.getPayload().entries.forEach(function(q){if(q.type==k.THREAD_TYPE){p.threads=p.threads.concat(q.mercury_thread);p.participants=p.participants.concat(q.participants_to_render);}});if(p.threads.length){h.handleUpdate(p);o.response.getPayload().entries.forEach(function(q){if(q.mercury_thread)q.text=j.renderThreadNameAndParticipantList(q.mercury_thread.thread_id,q.participants_to_render,q.mercury_thread.participants.length,{last_separator_uses_and:false,names_renderer:i.renderShortNames});});}});}};e.exports=l;});
__d("MessagingConst",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties'),h={APP_ID:313785040330,XD_MESSAGE:{SANDBOX_READY:'sandbox_ready',SET_CONTENT:'set_content',HTML_SIZE:'html_size',REFRESH_SIZE:'refresh_size'},SHINGLE_SCROLL_TRIGGER:5,EVENTS:{MESSAGE_SENT:'messaging/message_sent'},initConstants:function(i){g(h,i);}};e.exports=h;});
__d("MessagingXD",["Event","DOM","MercuryConstants","MessagingConst","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('DOM'),i=b('MercuryConstants'),j=b('MessagingConst'),k=b('URI'),l=b('copyProperties');function m(n){this._listeners=[g.listen(window,'message',this._onPostMessage.bind(this))];this._iframes={};this._contentWindows={};this._messageHandler=n;}l(m.prototype,{unload:function(){this._listeners.forEach(function(n){n.remove();});},createIframe:function(n,o,p){var q=new k(p);this._iframes[o]=h.create('iframe',{name:o,frameBorder:0,src:q.toString()});h.appendContent(n,this._iframes[o]);this._contentWindows[o]=this._iframes[o].contentWindow;return this._iframes[o];},sendMessage:function(n,o){var p=Array.prototype.slice.apply(arguments);p[0]=j.APP_ID;var q=this._iframes[n].contentWindow||this._contentWindows[n];q.postMessage(p.join(','),i.Sandbox.ORIGIN);},_onPostMessage:function(event){if(event.origin!==i.Sandbox.ORIGIN||!event.data.split)return;var n=event.data.split(','),o=unescape(n[1]);this._contentWindows[o]=event.source;this._messageHandler(o,n);}});e.exports=m;});
__d("HTMLEmailRenderer",["CSS","MessagingConst","MessagingXD","copyProperties","emptyFunction","tx","MercuryConstants"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('MessagingConst'),i=b('MessagingXD'),j=b('copyProperties'),k=b('emptyFunction'),l=b('tx'),m=b('MercuryConstants');function n(o,p){this._resizeContent=o.resizeContent||k;this._richMap={};this._useFBStyle=p;this._xdc=new i(this.onXDMessage.bind(this));this._maxWidth=0;}j(n.prototype,{onXDMessage:function(o,p){if(p[0]!=h.APP_ID.toString())return;if(this._richMap&&this._richMap[o])if(p[2]==h.XD_MESSAGE.SANDBOX_READY){return this.setIframeContent(o);}else if(p[2]==h.XD_MESSAGE.HTML_SIZE)return this._resizeContent(o,parseInt(p[3],10),parseInt(p[4],10),p[5]=='true',p[6]=='true');},setIframeContent:function(o,p){this._xdc.sendMessage(o,h.XD_MESSAGE.SET_CONTENT,escape(this._richMap[o]),this._useFBStyle?'useFBStyle':'',p?'forceDialogOnWide':'',escape("Show Hidden Text"),escape("Hide"),this._maxWidth);},makeRich:function(o,p,q,r){var s=this._xdc.createIframe(p,o,m.Sandbox.PAGE_URL);g.addClass(s,'xdIframe');this._richMap[o]=q;this._maxWidth=r||0;},updateRichMap:function(o,p){this._richMap[o]=p;},unload:function(){this._xdc.unload();}});e.exports=n;});
__d("ProgressBar",["CSS","DOM","Style","csx","cx","emptyFunction","requestAnimationFrame","removeFromArray","arrayContains"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Style'),j=b('csx'),k=b('cx'),l=b('emptyFunction'),m=b('requestAnimationFrame'),n=b('removeFromArray'),o=b('arrayContains'),p=[];function q(t,u,v){this._root=t;this._min=u||0;this._max=v||100;this._meter=h.find(t,"div._5e4k");this._meter2=h.scry(t,"div._5e2g")[0];this._initialPosition=0;this._position=0;this._initialVelocity=0;this._velocity=0;this._acceleration=0;this.useAcceleration=true;this._targetPosition=0;this._targetTime=0;this._startTime=null;this._onComplete=l;}q.prototype.getRoot=function(){return this._root;};q.prototype.setPosition=function(t){t=this._normalizePosition(t);this._initialPosition=t;this._position=t;this._updateMeter();this.stop();return this;};q.prototype.changeLabel=function(t){var u=h.scry(this._root,"span._5e2h");u.forEach(function(v){h.setContent(v,t);});return this;};q.prototype.setCompleteHandler=function(t){this._onComplete=t||l;return this;};q.prototype.setTarget=function(t,u){this._stopAnimating();this._targetPosition=t;var v=this._normalizePosition(t);this._targetTime=u;this._initialVelocity=this._velocity;this._initialPosition=this._position;if(this.useAcceleration){this._acceleration=2*(v-this._initialPosition-this._initialVelocity*u)/(u*u);}else{this._acceleration=0;this._velocity=this._initialVelocity=(v-this._initialPosition)/u;}if(this._position>=v){this._onComplete();}else this._start();return this;};q.prototype.setNoAcceleration=function(t){this.useAcceleration=!t;return this;};q.prototype.stop=function(){this._velocity=0;this._initialVelocity=0;this._acceleration=0;this._stopAnimating();return this;};q.prototype._start=function(){this._startTime=null;this._startAnimating();return this;};q.prototype._loop=function(t){this._startTime=this._startTime||t;var u=t-this._startTime;this._position=(.5*this._acceleration*u*u)+(this._initialVelocity*u)+this._initialPosition;var v=this._velocity;this._velocity=this._acceleration*u+this._initialVelocity;var w=v<0!==this._velocity<0;this._updateMeter();if(this._position>this._normalizePosition(this._targetPosition)||w){this._velocity=this._initialVelocity=0;this._acceleration=0;this.setPosition(this._targetPosition);this._onComplete();this._stopAnimating();}};q.prototype._updateMeter=function(){var t=Math.min(Math.max(this._position,0),1);g.conditionClass(this._meter,"_5e2d",t<=0);g.conditionClass(this._meter,"_5e4j",t>=1);t=t*100+'%';i.set(this._meter,'width',t);if(this._meter2){i.set(this._meter2,'left',t);i.set(this._meter2,'width',t);}};q.prototype._normalizePosition=function(t){return Math.min(Math.max((t-this._min)/(this._max-this._min),0),1);};q.prototype._startAnimating=function(){if(!o(p,this)){p.push(this);if(p.length===1)m(q.prototype._requestAnimationFrameCallback);}};q.prototype._stopAnimating=function(){n(p,this);};q.prototype._requestAnimationFrameCallback=function(t){p.forEach(function(u){u._loop(t);});if(p.length)m(q.prototype._requestAnimationFrameCallback);};function r(t,u){t.setPosition(u);}function s(t,u,v){t.setTarget(u,v);}e.exports=q;e.exports.setTarget=s;e.exports.setPosition=r;});
__d("FreeformTokenizerBehavior",["Input","Keys","Event","function-extensions"],function(a,b,c,d,e,f){var g=b('Input'),h=b('Keys'),i=b('Event');b('function-extensions');function j(k,l){var m=l.tokenize_on_blur!==false,n=l.tokenize_on_paste!==false,o=l.matcher&&new RegExp(l.matcher,'i'),p=l.paste_split&&new RegExp(l.paste_split),q=l.select_on_comma!==false,r=l.never_submit===true;function s(event){var t=g.getValue(k.getInput()).trim();if(p&&event&&event.type=='paste'){t=t.split(p);}else t=[t];var u=false;for(var v=0;v<t.length;v++){var w=t[v].trim();if(w&&(!o||o.test(w))){var x={uid:w,text:w,freeform:true};k.addToken(k.createToken(x));u=true;}}if(event&&u){k.getTypeahead().getCore().afterSelect();event.kill();}}k.subscribe('keydown',function(t,u){var event=u.event,v=i.getKeyCode(event);if((q&&v==h.COMMA)||v==h.RETURN){var w=k.getTypeahead().getView();if(w.getSelection()){w.select();event.kill();}else s(event);}if(v==h.RETURN&&r)event.kill();});k.subscribe('paste',function(t,u){if(n)s.bind(null,u.event).defer(20);});k.subscribe('blur',function(t,u){if(m)s();k.getTypeahead().getCore().reset();});}e.exports=j;});