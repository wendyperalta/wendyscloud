/*!CK:3411369776!*//*1379610793,171323698*/

if (self.CavalryLogger) { CavalryLogger.start_js(["bEYY7"]); }

__d("ComposerXDatepickerIconReset",["CSS","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('cx');function i(j){g.removeClass(j.element,"_4_na");g.removeClass(j.element,"_509o");}e.exports=i;});
__d("TimelineAggregatePost",["AsyncRequest","DataStore","DOM","Event","Parent","ScrollableArea","Style","cx"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('DataStore'),i=b('DOM'),j=b('Event'),k=b('Parent'),l=b('ScrollableArea'),m=b('Style'),n=b('cx'),o={init:function(p){j.listen(p,'click',function(q){var r=q.getTarget();if(q.isDefaultRequested()||r.tagName==='A'||k.byClass(r,"_1ww"))return true;var s=k.byTag(r,'li'),t=h.get(s,'url');g.bootstrap(t,s);});},initPage:function(p){j.listen(p,'click',function(q){var r=k.byClass(q.getTarget(),'uiCloseButton');if(r)return;var s=k.byTag(q.getTarget(),'li');new g().setURI(h.get(s,'url')).send();});},poke:function(p){l.poke(p);},setScrollHeight:function(p){var q=i.find(p,'.sArea');m.set(q,'height',p.offsetHeight+'px');}};e.exports=o;});
__d("legacy:TimelineAggregatePost",["TimelineAggregatePost"],function(a,b,c,d){a.TimelineAggregatePost=b('TimelineAggregatePost');},3);
__d("TimelineCommentsLoader",["Event","CommentPrelude","CSS","DOM","Parent","emptyFunction"],function(a,b,c,d,e,f){var g=b('Event'),h=b('CommentPrelude'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('emptyFunction'),m={init:function(){m.init=l;g.listen(document.body,'click',function(n){var o=k.byClass(n.getTarget(),'fbTimelineFeedbackCommentLoader');if(o){n.kill();h.click(o,false);var p=k.byTag(o,'form'),q=j.scry(p,'li.uiUfiViewAll input');if(!q.length)q=j.scry(p,'li.fbUfiViewPrevious input');if(!q.length)q=j.scry(p,'a.UFIPagerLink');q[0].click();i.show(j.find(p,'li.uiUfiComments'));i.removeClass(o,'fbTimelineFeedbackCommentLoader');}});}};e.exports=m;});
__d("TimelineCapsule",["Arbiter","CSS","DataStore","DOM","DOMQuery","DOMScroll","Parent","TimelineConstants","TimelineLegacySections","UserAgent","Vector","$","createArrayFrom","csx","isEmpty","queryThenMutateDOM","requestAnimationFrame"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DataStore'),j=b('DOM'),k=b('DOMQuery'),l=b('DOMScroll'),m=b('Parent'),n=b('TimelineConstants'),o=b('TimelineLegacySections'),p=b('UserAgent'),q=b('Vector'),r=b('$'),s=b('createArrayFrom'),t=b('csx'),u=b('isEmpty'),v=b('queryThenMutateDOM'),w=b('requestAnimationFrame'),x=(function(){var y=45,z=15,aa='use',ba='update',ca={},da={};function ea(ra){return h.hasClass(ra,'fbTimelineBalancer');}function fa(ra){return ra.getAttribute('data-spine');}function ga(ra){return h.hasClass(ra,'placeholderUnit');}function ha(ra,sa){if(sa)return (i.get(n.DS_SIDEORG,ra.id)||ra.getAttribute('data-side'));return ra.getAttribute('data-side');}var ia=function(ra,sa){if(p.ie()<=6){ia=function(ta,ua){i.set(n.DS_SIDEORG,ta.id,ha(ta,true));ta.setAttribute('data-side',ua);h.removeClass(ta,'leftColumn');h.removeClass(ta,'rightColumn');h.addClass(ta,ua=='l'?'leftColumn':'rightColumn');};}else ia=function(ta,ua){i.set(n.DS_SIDEORG,ta.id,ha(ta,true));ta.setAttribute('data-side',ua);};ia(ra,sa);};function ja(ra){return ra.getAttribute('data-size');}function ka(ra){if(h.hasClass(ra,'fbTimelineOneColumn')&&ra.prevSibling&&h.hasClass(ra.prevSibling,'fbTimelineOneColumn'))return z*2;if(h.hasClass(ra,'fbTimelineIndeterminateContent'))return 0;return z;}function la(ra,sa){var ta=0;if(h.shown(ra)&&!h.hasClass(ra,'placeholderUnit'))if(sa===aa){ta=i.get(n.DS_HEIGHT,ra.id,null);if(ta===null)ta=ra.getAttribute('data-calculatedheight');}else ta=ra.offsetHeight+ka(ra);if(sa===aa&&ta===null)ta=300;i.set(n.DS_HEIGHT,ra.id,parseInt(ta,10));}function ma(ra){var sa=i.get(n.DS_HEIGHT,ra.id,null);return sa;}function na(ra,sa){if(ja(sa)=='2'){return 0;}else if(ha(sa)=='r'){return ra+ma(sa);}else return ra-ma(sa);}function oa(ra){k.scry(ra,"._3ram").forEach(function(sa){var ta=sa.getAttribute('data-endmarker'),ua=sa.getAttribute('data-pageindex'),va=function(){if(!sa.parentNode)return;i.set(n.DS_LOADED,ra.id,ua);j.remove(sa);g.inform(n.SECTION_FULLY_LOADED,{scrubberKey:ta,pageIndex:ua,capsuleID:ra.id,childCount:ra.childNodes.length});};if(o.get(ta)){va();}else var wa=g.subscribe(n.SECTION_REGISTERED,function(xa,ya){if(ya.scrubberKey===ta){va();wa.unsubscribe();}});});g.inform('TimelineCapsule/balanced',{capsule:ra});}function pa(ra){if(u(ca[ra.id]))return;var sa=ea(ra)?ra.firstChild:ra,ta=sa.childNodes.length,ua={},va={},wa,xa=z,ya=z,za,ab=[];for(var bb=0;bb<ta;bb++){wa=sa.childNodes[bb];if(h.hasClass(wa,'fbTimelineUnit')){za=k.scry(wa,'div.timelineUnitContainer')[0];if(za)va[wa.id]=za.getAttribute('data-time');if(!ga(wa)&&h.shown(wa)){if(ja(wa)=='2'){ua[wa.id]=Math.max(xa,ya);xa=ya=ua[wa.id]+ma(wa);}else if(ha(wa)=='r'){ua[wa.id]=ya;ya+=ma(wa);}else{ua[wa.id]=xa;xa+=ma(wa);}if(ha(wa,true)=='l'||ja(wa)=='2')ab.push(wa.id);}}}for(bb=0;bb<ab.length-1;++bb){var cb=ab[bb],db=ab[bb+1],eb=ua[cb]+y,fb=ua[db];for(var gb in ca[ra.id]){if(eb>fb)break;var hb=ca[ra.id][gb];if(h.shown(hb))continue;if(va[gb]<=va[cb]&&va[gb]>va[db]){hb.style.top=eb+"px";eb+=y;h.show(hb);}}}}function qa(ra,sa){var ta=m.byAttribute(ra,'data-size');if(ta){if(h.hasClass(ra.parentNode,'timelineReportContent')){sa(ra);}else sa(ta);x.balanceCapsule(m.byClass(ta,'fbTimelineCapsule'));}}return {removeUnit:function(ra){qa(ra,function(sa){j.remove(sa);});},hideUnit:function(ra){qa(ra,function(sa){h.addClass(sa,'fbTimelineColumnHidden');});},undoHideUnit:function(ra,sa){j.remove(m.byClass(sa,'hiddenText'));qa(ra,function(ta){h.removeClass(ta,'fbTimelineColumnHidden');});},unplacehold:function(ra){var sa=r(ra);sa.style.top=null;h.removeClass(sa,'visiblePlaceholder');h.removeClass(sa,'placeholder');var ta=m.byClass(sa,'fbTimelineCapsule');delete ca[ta.id][ra];x.balanceCapsule(ta);},scrollToCapsule:function(ra){if(!da.hasOwnProperty(ra.id)){var sa=q.getElementPosition(ra.parentNode);l.scrollTo(new q(q.getScrollPosition().x,sa.y-n.SUBSECTION_SCROLL_TO_OFFSET,'document'));da[ra.id]=true;}},balanceCapsuleFromChild:function(ra,sa){x.balanceCapsule(m.byClass(ra,'fbTimelineCapsule'),sa);},balanceCapsuleDeferred:function(ra,sa){x.balanceCapsule.curry(ra,sa).defer();},balanceCapsule:function(ra,sa){if(!ra||!ra.childNodes)return;var ta=0,ua,va=document.createDocumentFragment(),wa=[],xa=[],ya=[],za=false,ab=sa&&sa.heights_action;if(sa&&sa.tail_balance)i.set(n.DS_TAILBALANCE,ra.id,sa.tail_balance);if(ab!==ba&&(p.chrome()||p.webkit()))h.toggleClass(ra,'webkitFix');for(var bb=0;bb<ra.childNodes.length;bb++){ua=ra.childNodes[bb];if(fa(ua)){continue;}else if(ea(ua)){s(ua.firstChild.childNodes).forEach(function(jb){la(jb,ab);});continue;}la(ua,ab);if(ha(ua,true)=='r'){xa.push(ua);}else wa.push(ua);ya.push(ua);if(ja(ua)!='2')if((ta>0&&ha(ua)=='r')||(ta<0&&ha(ua)=='l'))za=true;ta=na(ta,ua);}var cb=[],db=[],eb=[];k.scry(ra,'li.fbTimelineBalancer').forEach(function(jb){var kb=s(jb.firstChild.childNodes);if(jb.getAttribute('data-nonunits')){eb=eb.concat(kb);}else if(ha(jb)=='left'){cb=cb.concat(kb);}else if(ha(jb)=='right')db=db.concat(kb);});if(za){ra.style.minHeight=ra.offsetHeight;wa.forEach(function(jb){if(ja(jb)!='2')ia(jb,'l');});xa.forEach(function(jb){if(ja(jb)!='2')ia(jb,'r');});var fb=j.create('li',{className:'fbTimelineBalancer'},j.create('ol',null,wa));fb.setAttribute('data-side','left');j.prependContent(ra,fb);cb=wa.concat(cb);var gb=j.create('li',{className:'fbTimelineBalancer'},j.create('ol',null,xa));gb.setAttribute('data-side','right');j.prependContent(ra,gb);db=xa.concat(db);ta=0;}while(eb.length)va.appendChild(eb.shift());while((ta>=0&&cb.length)||(ta<0&&db.length)){if(ta>=0){ua=cb.shift();}else ua=db.shift();va.appendChild(ua);ta=na(ta,ua);}ra.appendChild(va);k.scry(ra,'li.fbTimelineBalancer').forEach(function(jb){if(!jb.firstChild.childNodes.length)j.remove(jb);});var hb=(sa&&sa.tail_balance)||i.get(n.DS_TAILBALANCE,ra.id);if(hb)ta=x.tailBalance(ra,ta,hb);if(za){ya.forEach(function(jb){if(jb.parentNode!==ra){ra.appendChild(jb);ta=na(ta,jb);}});ra.style.minHeight=null;}var ib=m.byClass(ra,'fbTimelineSection');if(ib)i.set(n.DS_COLUMN_HEIGHT_DIFFERENTIAL,ib.id,ta);ca[ra.id]={};k.scry(ra,'li.placeholderUnit').forEach(function(jb){ca[ra.id][jb.id]=jb;});pa(ra);oa(ra);if(ab===aa){sa.heights_action=ba;w(function(){w(x.balanceCapsule.curry(ra,sa));});}},tailBalance:function(ra,sa,ta){if(!ra)return sa;var ua=[],va=[],wa=[],xa=[];k.scry(ra,'li.fbTimelineBalancer').forEach(function(za){var ab=s(za.firstChild.childNodes);if(za.getAttribute('data-nonunits')){xa=xa.concat(ab);}else if(ha(za)=='left'){va=va.concat(ab);}else if(ha(za)=='right')wa=wa.concat(ab);ua=ua.concat(ab);});if((ta==n.FIXED_SIDE_RIGHT&&va.length)||(ta==n.FIXED_SIDE_LEFT&&wa.length))return sa;var ya=document.createDocumentFragment();if(ua)while(ua.length){if(ta!=n.FIXED_SIDE_NONE)if(ja(ua[0])!='2')if(sa>=0){ia(ua[0],'l');}else ia(ua[0],'r');sa=na(sa,ua[0]);ya.appendChild(ua.shift());}ra.appendChild(ya);k.scry(ra,'li.fbTimelineBalancer').forEach(function(za){if(!za.firstChild.childNodes.length)j.remove(za);});return sa;},loadTwoColumnUnits:function(ra){var sa=r(ra);v(function(){var ta=m.byClass(sa,'fbTimelineSection');if(ta){var ua=k.find(sa,"._3rbf"),va=k.find(sa,"._3rbh"),wa=va.offsetHeight-ua.offsetHeight;i.set(n.DS_COLUMN_HEIGHT_DIFFERENTIAL,ta.id,wa);}},oa.curry(sa));}};})();e.exports=a.TimelineCapsule||x;});
__d("TimelineCapsuleUtilities",["CSS"],function(a,b,c,d,e,f){var g=b('CSS'),h={setFirstUnit:function(i){var j=true;for(var k=0;k<i.childNodes.length;++k){var l=i.childNodes[k];if(l.id.indexOf('tl_unit_')===0)if(j){j=false;g.addClass(l,'firstUnit');}else{g.removeClass(l,'firstUnit');break;}}}};e.exports=h;});
__d("TimelineUnitSelector",["DOMQuery","Parent"],function(a,b,c,d,e,f){var g=b('DOMQuery'),h=b('Parent'),i={getUnitsWithTime:function(j){return g.scry(j,'div.timelineUnitContainer').filter(function(k){return (h.byClass(k,'fbTimelineCapsule')===j&&k.getAttribute('data-time'));});}};e.exports=i;});
__d("TimelineComposerUtilities",["Event","Arbiter","Bootloader","CSS","DOM","DOMQuery","Parent","TimelineUnitSelector","Vector","cx","csx"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('Bootloader'),j=b('CSS'),k=b('DOM'),l=b('DOMQuery'),m=b('Parent'),n=b('TimelineUnitSelector'),o=b('Vector'),p=b('cx'),q=b('csx'),r=86400*31,s=86400000,t={listenToSetEstimatedDate:function(u,v){return h.subscribe('ComposerXTimelineTagger/init',function(w,x){if(l.contains(u,x.datePickerElement)){t.setEstimatedDate(x.datePickerInstance,v());x.composerTimelineTagger.switchToTagger('date');}});},listenToSetEstimatedDateOld:function(u,v){return h.subscribe('TimelineBackdatedComposerTagger/initialized',function(event,w){if(w.composer===u)w.date_picker.subscribe('initialized',function(x,y){t.setEstimatedDate(y,v());});});},listenToPublish:function(u,v){if(u.root)u=u.root;return h.subscribe('composer/publish',function(event,w){if(w.composer_id===u.id)i.loadModules(['TimelineStoryPublisher'],function(x){x.publish(w);v&&v();});});},listenToAnotherComposerOpen:function(u,v){return h.subscribe('composer/mutate',function(w,x){if(x!==u)v();});},listenToCancel:function(u,v){return g.listen(u,'click',function(event){if(m.byClass(event.getTarget(),"_306"))v();});},listenToCancelOld:function(u,v){return g.listen(u,'click',function(event){m.byClass(event.getTarget(),'cancelBtn')&&v();});},hidePlaceIfAttachmentsTooTall:function(u){var v=l.find(u,"._2_4"),w=o.getElementDimensions(v).y;if(w>50)j.hide(l.find(v,"._mg"));},hidePlaceIfAttachmentsTooTallOld:function(u){var v=k.find(u,'ul.fbTimelineComposerAttachments'),w=o.getElementDimensions(v).y;if(w>50){var x=m.byTag(k.scry(v,'span.placeAttachment')[0],'li');x&&j.hide(x);}},setEstimatedDate:function(u,v){var w,x;if(v&&j.hasClass(v,'fbTimelineCapsule')){w=v.getAttribute('data-start');x=v.getAttribute('data-end');if(w&&x){var y=new Date(x*1000),z=new Date();if(y>z){u.setDate(z.getFullYear(),z.getMonth()+1,z.getDate());}else if(x-w>2*r){u.setDate(y.getFullYear());}else u.setDate(y.getFullYear(),y.getMonth()+1);}return;}var aa=m.byClass(v,'fbTimelineCapsule');if(aa){w=aa.getAttribute('data-start');x=aa.getAttribute('data-end');var ba=o.getElementPosition(v).y,ca=[x,null],da=[w,null],ea=n.getUnitsWithTime(aa);for(var fa=0;fa<ea.length;fa++){var ga=ea[fa],ha=k.scry(ga.parentNode,'.spinePointer')[0];if(!ha)continue;var ia=o.getElementPosition(ha).y;if(ia<=ba){if(!ca[1]||ia>ca[1])ca=[ga.getAttribute('data-time'),ia];}else if(!da[1]||ia<da[1])da=[ga.getAttribute('data-time'),ia];}if(ca[0]!==null&&da[0]!==null){var ja=Math.round((parseInt(ca[0],10)+parseInt(da[0],10))/2)*1000;ja=Math.min(new Date()-s,ja);u.setDateWithTimestamp(ja);}}},showMLEFlyout:function(u){var v=k.scry(document,'a.fbTimelineSpine').length===0,w=function(x){x.showMLEFlyout(u);};if(v){i.loadModules(['TimelineSpinelessComposer'],w);}else i.loadModules(['TimelineComposer'],w);}};e.exports=t;});
__d("TimelineComposer",["Arbiter","Bootloader","CSS","DOM","Parent","Run","TimelineCapsule","TimelineCapsuleUtilities","TimelineComposerUtilities","$","cx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Run'),m=b('TimelineCapsule'),n=b('TimelineCapsuleUtilities'),o=b('TimelineComposerUtilities'),p=b('$'),q=b('cx'),r;function s(x){if(x.isScheduledPost||x.isOGPost)return;if(!x.streamStory){window.location.reload();return;}if(x.backdatedTime){h.loadModules(['TimelineStoryPublisher'],function(z){z.publish(x);});return;}var y=w.renderCapsuleBasedStory(r,x.streamStory);g.inform('TimelineComposer/on_after_publish',y,g.BEHAVIOR_PERSISTENT);}function t(){var x=k.byClass(r,'fbTimelineTwoColumn');return j.find(x,'.spinePointer');}function u(x){var y=v();i.show(y);var z=x.subscribe('hide',function(){i.hide(y);x.unsubscribe(z);});}function v(){var x=k.byClass(r,'fbTimelineTwoColumn'),y=j.scry(x,'div.composerVeil');if(y.length!==1)y=j.appendContent(x,j.create('div',{className:'composerVeil hidden_elem'}));return y[0];}var w={init:function(x){r=p(x);var y=g.subscribe('composer/publish',function(event,z){if(z.composer_id===r.id)s(z);});l.onLeave(y.unsubscribe.bind(y));if(i.hasClass(r,"_mj")){o.hidePlaceIfAttachmentsTooTall(r);}else o.hidePlaceIfAttachmentsTooTallOld(r);},showMLEFlyout:function(x){x.setContext(t()).show();u(x);},renderCapsuleBasedStory:function(x,y){var z=k.byClass(x,'fbTimelineCapsule');if(!z)return;var aa=k.byClass(x,'timelineUnitContainer').parentNode;if(aa.nextSibling.getAttribute('data-spine'))aa=aa.nextSibling;var ba=j.insertAfter(aa,y)[0];h.loadModules(['Animation'],function(ca){new ca(ba.firstChild).from('backgroundColor','#fff8dd').to('backgroundColor','#fff').duration(2000).ease(ca.ease.both).go();});n.setFirstUnit(z);m.balanceCapsule(z);return ba;}};e.exports=a.TimelineComposer||w;});
__d("TimelineContentLoader",["function-extensions","Arbiter","CSS","DOM","DOMScroll","Event","OnVisible","Parent","ScrollingPager","TimelineConstants","TimelineController","TimelineLegacySections","TimelineSmartInsert","TimelineURI","UIPagelet","UserAgent","Vector","$","arrayContains","copyProperties","createArrayFrom","csx","debounce","ge","startsWith","tx","userAction"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('DOMScroll'),k=b('Event'),l=b('OnVisible'),m=b('Parent'),n=b('ScrollingPager'),o=b('TimelineConstants'),p=b('TimelineController'),q=b('TimelineLegacySections'),r=b('TimelineSmartInsert'),s=b('TimelineURI'),t=b('UIPagelet'),u=b('UserAgent'),v=b('Vector'),w=b('$'),x=b('arrayContains'),y=b('copyProperties'),z=b('createArrayFrom'),aa=b('csx'),ba=b('debounce'),ca=b('ge'),da=b('startsWith'),ea=b('tx'),fa=b('userAction'),ga=false,ha=false,ia,ja=null,ka={},la=[],ma=[],na=[],oa={},pa={},qa={},ra={},sa=null,ta=false,ua=null;function va(fb,gb,hb,ib,jb){this.node=fb;this.loaded=ib;this.canScrollLoad=true;this.canUnload=gb!=eb.RECENT;this.scrubberKey=gb;this.historicUnitCount=jb;this._pageletLoadData=hb;this._expandPageletLoadData={};this.rightColumnFinished=false;}va.prototype.load=function(fb,gb){if(this.loaded)return;var hb=this._pageletLoadData;g.inform(o.SECTION_LOADING,{data:hb,scrubberKey:this.scrubberKey});this.loaded=true;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');var ib='ProfileTimelineSectionPagelet',jb=this.scrubberKey==eb.WAY_BACK;if(jb)ib='ProfileTimelineRemainingYearsPagelet';hb.highlight_unit_data=fb;hb.parent_key=this.parentKey;hb.force_no_friend_activity=ta;h.conditionClass(this.node,'combinedSections',hb.combine_sections);h.conditionClass(this.node,'fbTimelineSectionLoading',!hb.combine_sections);if(this.canUnload&&ha){var kb=this.node.firstChild.cloneNode(true);h.hide(kb);i.insertAfter(this.node,kb);}else this.canScrollLoad=false;var lb=null;if(gb&&!hb.combine_sections){this.node.style.minHeight=window.innerHeight+'px';lb=function(){this.node.style.minHeight='';ab(this.scrubberKey);}.bind(this);}else if(hb.combine_sections)lb=function(){ab(this.scrubberKey);eb.hideSection(this.scrubberKey);}.bind(this);var mb=hb.combine_sections&&jb;qa[this.scrubberKey]=t.loadFromEndpoint(ib,mb?hb.unit_container_id+'_left':this.node.id,hb,{usePipe:true,jsNonblock:true,constHeight:true,append:mb,finallyHandler:lb});db(this.scrubberKey);};va.prototype.preload=function(){h.addClass(this.node,'fbTimelineTimePeriodSuppressed');h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');var fb=i.find(this.node,'span.sectionLabel');if(fb.getAttribute('data-original-label')){i.setContent(fb,fb.getAttribute('data-original-label'));fb.removeAttribute('data-original-label');}};va.prototype.unload=function(){if(!this.loaded||!this.canUnload)return;this.loaded=false;qa[this.scrubberKey]&&qa[this.scrubberKey].cancel();h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');if(this.node.nextSibling&&h.hasClass(this.node.nextSibling,'fbTimelineSection')){i.setContent(this.node,this.node.nextSibling);h.show(this.node.firstChild);}else i.empty(this.node);this.deactivateScrollLoad();};va.prototype.activateScrollLoad=function(){this.canScrollLoad=true;h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');pa[this.scrubberKey]&&pa[this.scrubberKey].reset();};va.prototype.deactivateScrollLoad=function(){if(!this.loaded){this.canScrollLoad=false;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.addClass(this.node,'fbTimelineTimePeriodSuppressed');pa[this.scrubberKey]&&pa[this.scrubberKey].remove();}};va.prototype.setExpandLoadData=function(fb){this._expandPageletLoadData=fb;return this;};va.prototype.appendData=function(fb){y(this._pageleLoadData,fb);return this;};va.prototype.expandSubSections=function(){if(this.subSections.length)eb.navigateToSection(this.subSections[0].scrubberKey);};va.prototype.expand=function(fb){if(!this.loaded)return;sa.add_event('expand_'+this.scrubberKey);var gb=i.find(this.node,'.fbTimelineSectionExpander');h.addClass(gb.firstChild,'async_saving');fb&&h.addClass(fb,'async_saving');eb.navigateToSection(this.scrubberKey);i.scry(this.node,'.fbTimelineCapsule').forEach(i.remove);this._expandPageletLoadData.new_expand=true;qa[this.scrubberKey]&&qa[this.scrubberKey].cancel();qa[this.scrubberKey]=t.loadFromEndpoint('ProfileTimelineSectionPagelet',gb.id,this._expandPageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true});};va.prototype.isPermalinkPeriod=function(){return this._pageletLoadData.is_permalink_period;};va.prototype.shouldCombineSections=function(){return this._pageletLoadData.combine_sections;};function wa(){if(ga)return;p.register(p.CONTENT,eb);sa=fa('timeline').uai('init','scrubber',false);ga=true;if(u.ie()<=7)ha=true;}var xa=ba(function(fb,gb,hb){var ib=q.get(fb).historicUnitCount;gb-=ib;hb-=1;if(ib==-1||hb<=0||gb<0)return;var jb=eb.getNextSectionKey(fb);if(jb){q.get(jb).load();xa(jb,gb,hb);}},500);function ya(fb,gb,hb,ib){var jb=eb.getNextSectionKey(gb);if(jb){pa[jb]=new l(fb,za.curry(jb,fb),false,hb||1000);}else if(gb!==eb.WAY_BACK){ib=ib?ib:0;if(ib>80)return null;ya.curry(fb,gb,hb,ib+1).defer(250);}}function za(fb,gb){var hb=q.get(fb);if(hb&&hb.canScrollLoad){sa.add_event("scroll_load_"+fb);if(ha){hb.preload();}else{hb.load();if(ua&&!hb.shouldCombineSections())xa(fb,ua.required_units,ua.max_parallelism);}gb&&i.remove(gb);}}function ab(fb){var gb=pa[fb];if(gb){gb.remove();pa[fb]=null;i.remove(gb.getElement());}}function bb(){var fb,gb,hb=false;for(var ib=0;ib<la.length;ib++){var jb=la[ib];if(!jb)continue;var kb=q.get(jb);if(kb&&(kb.canScrollLoad||kb.loaded)){if(!kb.loaded){h.removeClass(kb.node,'fbTimelineTimePeriodSuppressed');h.addClass(kb.node,'fbTimelineTimePeriodUnexpanded');}if(fb&&gb){cb(fb,gb);if(hb)fb.deactivateScrollLoad();hb=true;}fb=null;gb=null;continue;}else if(fb){gb=kb;kb.deactivateScrollLoad();}else{fb=kb;if(hb)kb.activateScrollLoad();}h.removeClass(kb.node,'fbTimelineTimePeriodSuppressed');h.addClass(kb.node,'fbTimelineTimePeriodUnexpanded');}}function cb(fb,gb){h.removeClass(gb.node,'fbTimelineTimePeriodUnexpanded');h.addClass(gb.node,'fbTimelineTimePeriodSuppressed');var hb=i.find(fb.node,'span.sectionLabel'),ib=i.find(gb.node,'span.sectionLabel');if(!ib.getAttribute('data-original-label'))ib.setAttribute('data-original-label',i.getText(ib));if(hb.getAttribute('data-month')&&ib.getAttribute('data-month')&&hb.getAttribute('data-year')==ib.getAttribute('data-year')){i.setContent(ib,ea._("Show {month1} - {month2} {year}",{month1:ib.getAttribute('data-month'),month2:hb.getAttribute('data-month'),year:hb.getAttribute('data-year')}));}else if(hb.getAttribute('data-year')!==ib.getAttribute('data-year')){i.setContent(ib,ea._("Show {year1} - {year2}",{year1:ib.getAttribute('data-year'),year2:hb.getAttribute('data-year')}));}else i.setContent(ib,ea._("Show {year}",{year:ib.getAttribute('data-year')}));}function db(fb){if(ha)for(var gb=0;gb<la.length-1;gb++){var hb=la[gb];if(!hb)continue;if(hb!=fb){var ib=q.get(hb);if(ib.loaded&&ib.canUnload)ib.unload();}}bb();}var eb={WAY_BACK:'way_back',RECENT:'recent',HEADER_SCROLL_CUTOFF:80,CURRENT_SECTION_OFFSET:150,FOOTER_HEIGHT:60,registerTimePeriod:function(fb,gb,hb,ib,jb,kb,lb){wa();if(x(na,gb))return;if(ma)y(hb,ma);var mb=new va(fb,gb,hb,ib,lb);if(!jb){la[kb]=gb;ka[gb]=true;}else{mb.parentKey=jb;q.get(jb).subSections=q.get(jb).subSections||[];q.get(jb).subSections[kb]=mb;}if(mb.shouldCombineSections())p.hideStickyHeaderNavSectionMenu();q.set(gb,mb);eb.checkCurrentSectionChange();g.inform(o.SECTION_REGISTERED,{scrubberKey:gb});},reset:function(){for(var fb in pa)pa[fb]&&pa[fb].remove();for(var gb in qa)qa[gb]&&qa[gb].cancel();for(var hb in ra){ra[hb].unsubscribe();delete ra[hb];}ia&&ia.unsubscribe();ia=null;q.removeAll();ja=null;ka={};la=[];ma=[];na=[];oa={};pa={};qa={};sa=null;ta=false;ga=false;},checkCurrentSectionChange:function(){var fb=eb.getCurrentSection(),gb=ja&&ja.scrubberKey;if(fb&&fb.scrubberKey!==gb&&!fb.isPermalinkPeriod()){ja=fb;var hb=fb.scrubberKey,ib=fb.parentKey;if(!ib){ib=hb;hb=null;}p.sectionHasChanged(ib,hb);}},setParallelLoadConfig:function(fb){ua=fb;},getCurrentSection:function(){var fb={},gb=q.getAll();for(var hb in gb){var ib=gb[hb];if(!ib.loaded||oa[ib.scrubberKey])continue;var jb=v.getElementPosition(ib.node,'viewport').y;if(ib.scrubberKey=='recent')jb--;if(jb<eb.CURRENT_SECTION_OFFSET)fb[jb]=ib;}var kb=Math.max.apply(null,Object.keys(fb)),lb=kb==-Infinity;if(!lb){return fb[kb];}else if(la[0])return q.get(la[0]);return null;},capsuleForCurrentSection:function(){var fb=eb.getCurrentSection();return fb&&i.scry(fb.node,'.fbTimelineCapsule')[0];},enableScrollLoad:function(fb,gb,hb,ib){fb=w(fb);var jb=m.byClass(fb,'fbTimelineSection')||fb.parentNode,kb=jb&&i.scry(jb,'.fbTimelineCapsule')[0];if(!kb)return;if(hb===null){ya(fb,gb,ib);}else p.runOnceWhenSectionFullyLoaded(ya.curry(fb,gb,ib),gb,hb);},enableScrollLoadOnClick:function(fb,gb,hb){fb=w(fb);k.listen(fb,'click',function(ib){ib.prevent();eb.enableScrollLoad(fb,gb,null,hb);});},expandSectionOnClick:function(fb,gb){k.listen(fb,'click',function(hb){hb.prevent();q.get(gb).expand();});},expandSubSectionsOnClick:function(fb,gb){k.listen(fb,'click',function(hb){hb.prevent();q.get(gb).expandSubSections();});},getNextSectionKey:function(fb){for(var gb=0;gb<la.length-1;gb++)if(la[gb]==fb){while(gb<la.length-1&&!la[gb+1])gb++;return la[gb+1];}var hb=q.get(fb);if(!hb||!hb.parentKey)return;var ib=q.get(hb.parentKey);if(!ib)return;for(var jb=0;jb<ib.subSections.length-1;jb++)if(ib.subSections[jb].scrubberKey==fb)return ib.subSections[jb+1].scrubberKey;},hideSection:function(fb){var gb=q.get(fb);gb&&h.hide(i.find(gb.node,'.fbTimelineSection'));var hb=p.getCurrentScrubber();if(hb){var ib=p.getCurrentScrubber().getNav(fb);ib&&h.hide(ib);}var jb=p.getCurrentStickyHeaderNav();jb&&jb.removeTimePeriod(fb);oa[fb]=true;},loadSectionOnClick:function(fb,gb){k.listen(fb,'click',function(hb){hb.prevent();q.get(gb).load();});},removeSection:function(fb){for(var gb in la)if(la[gb]==fb){la[gb]=null;break;}q.remove(fb);delete ka[fb];if(fb in pa){pa[fb].remove();delete pa[fb];}var hb=p.getCurrentStickyHeaderNav();hb&&hb.removeTimePeriod(fb);na.push(fb);},removeSectionParent:function(fb){i.remove(w(fb).parentNode);},navigateToSection:function(fb,gb,hb){sa.add_event("nav_"+fb);gb=!!gb;var ib=fb,jb=q.get(fb);if(!jb)return;if(!jb.loaded){r.enable();i.scry(w('timeline_tab_content'),'.fbTimelineShowOlderSections').forEach(i.remove);}if(!ka[fb]){jb.node.style.minHeight=v.getViewportDimensions().y+'px';var kb=g.subscribe(o.SECTION_FULLY_LOADED,function(sb,tb){if(tb.scrubberKey===fb){jb.node.style.minHeight='';kb.unsubscribe();}});ib=jb.parentKey;var lb=q.get(ib).node;if(!h.hasClass(lb,'fbTimelineSectionExpanded')){j.scrollTo(lb,0);h.addClass(lb,'fbTimelineSectionExpanded');i.scry(lb,'.fbTimelineCapsule').forEach(i.remove);i.scry(lb,'div.fbTimelineSectionExpandPager').forEach(i.remove);i.scry(lb,'div.fbTimelineContentHeader').forEach(i.remove);i.scry(lb,"._5vf").forEach(function(sb){if(!sb.getAttribute('data-subsection'))i.remove(sb);});}var mb=eb.getNextSectionKey(ib);if(mb&&pa[mb])pa[mb].setBuffer(0);}for(var nb=0;nb<la.length;nb++){var ob=la[nb];if(!ob)continue;if(ob==ib)break;q.get(ob).deactivateScrollLoad();i.scry(w('timeline_tab_content'),'.fbTimelineSectionExpandPager').forEach(function(sb){var tb=n.getInstance(sb.id);tb&&tb.removeOnVisible();});}eb.adjustContentPadding();jb.load(hb,true);bb();var pb=v.getScrollPosition().x,qb=v.getElementPosition(jb.node).y;if(!gb){var rb=ka[fb]?o.SCROLL_TO_OFFSET:o.SUBSECTION_SCROLL_TO_OFFSET;j.scrollTo(new v(pb,qb-rb,'document'),true,false,false,function(){var sb=v.getElementPosition(jb.node).y;j.scrollTo(new v(pb,sb-rb,'document'),false);var tb=i.scry(jb.node,'h3.uiHeaderTitle')[0];if(tb){tb.tabIndex=0;tb.focus();}});}},adjustContentPadding:function(){var fb=ca('timeline_tab_content');if(!fb)return;if(p.isOneColumnMinimal())return;var gb=p.getCurrentKey()||s.TIMELINE_KEY;if(gb!==s.TIMELINE_KEY)return;var hb=la.length-1,ib=q.get(la[hb]);fb.style.paddingBottom=ib&&ib.loaded?null:v.getViewportDimensions().y-eb.CURRENT_SECTION_OFFSET-eb.HEADER_SCROLL_CUTOFF-eb.FOOTER_HEIGHT+'px';},adjustContentPaddingAfterLoad:function(fb,gb){p.runOnceWhenSectionFullyLoaded(eb.adjustContentPadding,fb,gb);},appendContentAfterLoad:function(fb,gb,hb){p.runOnceWhenSectionFullyLoaded(i.appendContent.curry(w(fb),gb),hb,'0');},markSectionAsLoaded:function(fb,gb,hb){p.runOnceWhenSectionFullyLoaded(function(){ca(fb)&&h.removeClass(w(fb).parentNode,'fbTimelineSectionLoading');},gb,hb);},suppressSectionsAbove:function(fb){var gb,hb;for(var ib=0;ib<la.length;ib++){var jb=la[ib];if(!jb)continue;gb=q.get(jb).node;hb=null;if(z(fb.parentNode.children).indexOf(fb)<=z(gb.parentNode.children).indexOf(gb)){hb=jb;break;}q.get(jb).deactivateScrollLoad();}if(hb)eb.navigateToSection(hb,true);},forceNoFriendActivity:function(){ta=true;},removeDupes:function(fb){var gb=ca(fb);if(!gb)return;var hb=i.scry(gb,'li.fbTimelineUnit'),ib={};for(var jb=0;jb<hb.length;jb++){var kb=hb[jb];if(kb.id&&da(kb.id,'tl_unit_')){var lb=kb.id.substring(8,kb.id.length),mb=i.scry(kb,'div.timelineUnitContainer');if(mb.length>0)lb=lb+mb[0].getAttribute('data-time');if(ib.hasOwnProperty(lb)){kb.id='dupe_unit_'+Math.random();kb.className="hidden_elem";}else ib[lb]=1;}}},removeLoadingState:function(fb){ca(fb)&&h.removeClass(w(fb),'fbTimelineSectionLoading');},setExpandLoadDataForSection:function(fb,gb){var hb=q.get(fb);hb&&hb.setExpandLoadData(gb);},appendSectionDataForAllSections:function(fb){ma=fb;for(var gb=0;gb<la.length-1;gb++){var hb=la[gb];if(!hb)continue;var ib=q.get(hb);ib&&ib.appendData(fb);}},updatePagerAfterLoad:function(fb,gb,hb,ib,jb){var kb=n.getInstance(fb.firstChild.id);if(!kb){ra[fb.firstChild.id]=g.subscribe(n.REGISTERED,function(lb,mb){ra[fb.firstChild.id].unsubscribe();delete ra[fb.firstChild.id];if(mb.id===fb.firstChild.id)eb.updatePagerAfterLoad(fb,gb,hb,ib,jb);});return;}p.runOnceWhenSectionFullyLoaded(function(){h.removeClass(fb,'fbTimelineHiddenPager');kb.checkBuffer();},hb,ib);if(jb)p.runOnceWhenSectionFullyLoaded(p.adjustScrollingPagerBuffer.curry(fb.firstChild.id,gb),hb,ib);},showAfterLoad:function(fb,gb,hb){p.runOnceWhenSectionFullyLoaded(function(){var ib=ca(fb);ib&&h.show(ib);},gb,hb);},repositionDialog:function(fb){g.subscribe(o.SECTION_LOADED,function(){fb.updatePosition();});},rightColumnFinished:function(fb){var gb=q.get(fb);gb.rightColumnFinished=true;},addUnrankedUnits:function(fb){var gb=w(fb),hb=i.scry(gb,'li.fbTimelineUnit');for(var ib=hb.length-1;ib>=0;ib--){var jb=hb[ib];i.insertAfter(gb,jb);h.addClass(i.find(jb,'div.timelineUnitContainer'),'fbTimelineHighlightUnit');}i.remove(gb);}};e.exports=eb;});
__d("TimelineLogging",["TimelineController","reportData"],function(a,b,c,d,e,f){var g=b('TimelineController'),h=b('reportData'),i=false,j=0,k=null,l=null,m={init:function(n){if(i)return;j=n;g.register(g.LOGGING,this);},reset:function(){i=false;j=0;k=null;},log:function(n,o){o.profile_id=j;h(n,{gt:o});},logSectionChange:function(n,o){var p={timeline_section_change:1,key:n};if(k&&n==k){p.timeline_scrubber=1;k=null;}if(l&&n==l){p.sticky_header_nav=1;l=null;}m.log('timeline',p);},logScrubberClick:function(n){k=n;},logStickyHeaderNavClick:function(n){l=n;}};e.exports=m;});
__d("TimelineSpinelessComposer",["Arbiter","Bootloader","CSS","DOM","Parent","Run","TimelineComposer","TimelineComposerUtilities","csx","cx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Run'),m=b('TimelineComposer'),n=b('TimelineComposerUtilities'),o=b('csx'),p=b('cx'),q;function r(w){if(w.isScheduledPost||w.isOGPost)return;if(!w.streamStory){window.location.reload();return;}if(w.backdatedTime){h.loadModules(['TimelineStoryPublisher'],function(x){x.publish(w);});return;}m.renderCapsuleBasedStory(q,w.streamStory);}function s(){return j.find(k.byClass(q,'fbTimelineComposerCapsule'),"div._4s3");}function t(w){var x=u();i.show(x);var y=w.subscribe('hide',function(){i.hide(x);w.unsubscribe(y);});}function u(){var w=k.byClass(q,'fbTimelineComposerCapsule'),x=j.scry(w,'div.composerVeil');if(x.length!==1)x=j.appendContent(w,j.create('div',{className:'composerVeil hidden_elem'}));return x[0];}var v={init:function(w){q=w;var x=g.subscribe('composer/publish',function(event,y){if(y.composer_id===q.id)r(y);});l.onLeave(x.unsubscribe.bind(x));if(i.hasClass(q,"_mj")){n.hidePlaceIfAttachmentsTooTall(q);}else n.hidePlaceIfAttachmentsTooTallOld(q);},showMLEFlyout:function(w){w.setContext(s()).show();t(w);}};e.exports=v;});
__d("TimelineStickyRightColumn",["Arbiter","CSS","DOMQuery","Event","PhotoSnowlift","Run","Style","TimelineContentLoader","Vector","UserAgent","csx","queryThenMutateDOM"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOMQuery'),j=b('Event'),k=b('PhotoSnowlift'),l=b('Run'),m=b('Style'),n=b('TimelineContentLoader'),o=b('Vector'),p=b('UserAgent'),q=b('csx'),r=b('queryThenMutateDOM'),s=100,t=15,u=15,v=71,w=false,x=null,y=null,z,aa,ba,ca,da,ea,fa,ga;function ha(){if(k.getInstance().isOpen)return;z=n.getCurrentSection();if(!z||!z.rightColumnFinished)return;var pa=i.scry(z.node,"._3rbf")[0],qa=i.scry(z.node,"._3rbh")[0];aa=pa?pa.offsetHeight:0;ba=qa?qa.offsetHeight:0;ca=o.getViewportDimensions().y;fa=pa?o.getElementPosition(pa).y:0;ga=document.body.clientWidth<document.body.scrollWidth;}function ia(){if(k.getInstance().isOpen)return;if(y&&y!==z){var pa=i.scry(y.node,"._3rbh")[0];if(pa)ka(pa,'','','');}var qa=i.scry(z.node,"._3rbh")[0];if(!qa)return;if(ga){ka(qa,'','','');return;}if(!z||!z.rightColumnFinished)return;ja(z);y=h.hasClass(qa,'fixed_always')?z:null;}function ja(pa){if(ba>=aa||aa<=ca)return;ea=da;da=o.getScrollPosition().y;var qa,ra=i.scry(pa.node,"._3rbh")[0];if(!ra)return;if(da<=fa-la()){ka(ra,'','','');return;}if(aa+fa<=da+Math.min(ba+la(),ca-u-v)){ka(ra,'absolute','',u+'px');return;}if(ba>ca-u-la()){if(da<ea){var sa=false;if(ra.style.position==='absolute')if(ra.style.top!==''&&da+la()-fa<=parseInt(ra.style.top,10)){sa=true;}else if(ra.style.bottom!==''&&da<=(fa+aa-la())-ba)sa=true;if(sa){ka(ra,'fixed',la()+'px','');return;}else if(ra.style.position==='absolute'&&ra.style.top){return;}else if(h.hasClass(ra,'fixed_always')){if(parseInt(ra.style.top,10)>=la())return;qa=da-fa-(ba-(ca-v));if(ea)qa+=ea-da;ka(ra,'absolute',qa+'px','');return;}}else{var ta=false;if(ra.style.position==='absolute'||(ra.style.position===''&&!h.hasClass(ra,'fixed_always'))){qa=ra.style.top?parseInt(ra.style.top,10):0;if(da+ca>=fa+qa+ba+v)ta=true;}if(ta){qa=ca-ba-u-v;ka(ra,'fixed',qa+'px','');return;}else if(da==ea){return;}else if(h.hasClass(ra,'fixed_always')){if(parseInt(ra.style.top,10)>=la()){qa=da-fa+la();if(ea)qa+=ea-da;ka(ra,'absolute',qa+'px','');return;}}else if(ra.style.position==='absolute')return;}}else ka(ra,'fixed',la()+'px','');}function ka(pa,qa,ra,sa){m.set(pa,'bottom',sa);if(qa==='fixed'){h.addClass(pa,'fixed_always');m.set(pa,'position','');}else{h.removeClass(pa,'fixed_always');m.set(pa,'position',qa);}m.set(pa,'top',ra);g.inform('reflow');}function la(){return h.hasClass(document.documentElement,'tinyViewport')?t:s;}function ma(){r(ha,ia);}function na(){w=false;y=null;while(x.length)x.pop().remove();x=null;}var oa={init:function(){if(w||p.ie()<8)return;w=true;x=[j.listen(window,'scroll',ma),j.listen(window,'resize',ma)];l.onLeave(na);},adjust:function(){if(w){ha();ia();}}};e.exports=oa;});